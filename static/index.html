<html>

<head>
  <title>Users stats</title>
  <style>
    body {
      font-family: 'Times New Roman', Times, serif;
      padding: 20px;
      background-color: #f5f5f5;
      margin: 0 auto
    }

    table {
      width: 100%;
      max-width: 600px;
      background: white;
    }

    th,
    td {
      padding: 10px 7px;
      text-align: center;
    }

    th {
      background: #9a9a9a;
    }
  </style>
</head>

<body>
  <table>
    <thead>
      <tr>
        <th>email</th>
        <th>#templates</th>
        <th>#generation</th>
      </tr>
    </thead>
    <tbody id="users-table-body">
      <tr>
        <td colspan="3" , class="loading">Loading...</td>
      </tr>
    </tbody>
  </table>
</body>
<script>
  fetch("http://127.0.0.1:8000/users")
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    })
    .then(data => {
      console.log('Успешно получено:', data);
      const table = document.getElementById("users-table-body");
      table.innerHTML = '';
      data.forEach(user => {
        const row = document.createElement("tr");
        ["email", "templates", "generations"].map(prop => {
          const td = document.createElement("td");
          td.innerHTML = user[prop];
          row.appendChild(td);
        });
        table.appendChild(row);
      });
    })
    .catch(error => {
      console.error('Ошибка:', error);
    });
</script>

</html>